<%= tinymce_assets %>
<div class="row">
<%= render "layouts/subscriber" %>
	<div class="col-md-6 col-md-offset-3">
		<h1 id="posttitle"><%= @post.title %></h1>
		<p>
		  <div id="postcontent">
		  	<%= @post.content.html_safe %>
		  </div>
		  <% if @post.image_file_name != nil %>
		  <div id="postimage">
		  	<%= link_to image_tag(@post.image.url(:large)), @post.image.url %>
		  </div>
		  <% end %>
		  <% if @post.tags.any? %>
		  	<span class="glyphicon glyphicon-tags">
		  		<% @post.tags.each do |tag| %>
		  			<%= link_to tag.name, tagged_path(:tag => tag.name) %>
					<% end %>
				</span>
			<% end %>
		</p>
		<div id="rating">
			<%= link_to @post.posted_by, '#' %>
			<%= rating_for @post, 'content', enable_half: true, half_show: true,cancel: true %>
		</div>	
		<% if @post.likes.count != 0 %>
			<%= link_to "#{@post.likes.count} Likes", liked_by_post_path %> |
		<% end %>
		<% if !@post.liked_by.include?(current_user) %>
			<span class="glyphicon glyphicon-thumbs-up"></span>
			<%= link_to "Like", likes_path(:post_id => @post),method: :post %>	 
		<% else %>
			<% like = current_user.likes.find_by(:post_id => @post) %>
			<span class="glyphicon glyphicon-thumbs-down"></span>
			<%= link_to "Unlike", like_path(like),method: :delete %>
		<% end %>
		<% if @post.user_id == current_user %>
			<div>
				<%= link_to 'Edit', edit_post_path(@post) %> |
				<%= link_to 'Destroy', @post, method: :delete, data: { confirm: 'Are you sure?' } %>
			</div>
		<% end %>

		Share:
		<%= social_share_button_tag(@post.title) %>

		Comments:
		<% comments =  @post.comments.where("reply_to" => nil) %>
		<%= render partial: "shared/comment", locals: {comments: comments, l: 0, post: @post} %>


		<h5>Add a comment:</h5>
		<%= form_for([@post, @post.comments.build]) do |f| %>
		  <%= f.text_area :content, class: 'form-control' %><br>
		  <%= f.submit class:"btn btn-primary" %>
		<% end %>
		<% if @post.user_id == current_user %>
			<%= link_to 'Edit', edit_post_path(@post) %> |
		<% end %>
		<%= link_to 'Back', posts_path %>
		<%= tinymce %>
	</div>
</div>
		  